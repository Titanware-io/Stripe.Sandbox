@using System.Collections.Generic
@using System.Linq
@using Microsoft.AspNetCore.Http
@model Stripe.Onboarding.Features.Cart.Models.Views.CheckoutPage

<div>checkout</div>
 
<div id="checkout">
    <!-- Checkout will insert the payment form here -->
</div>

<article class="dense">
    
    <footer>
        <nav>
            <ul>
                <li>
                    <button>Cancel</button>
                </li>
            </ul>
        </nav>
    </footer>
</article>

<script>
    // This is a public sample test API key.
    // Don’t submit any personally identifiable information in requests made with this key.
    // Sign in to see your own test API key embedded in code samples.
    const stripe = Stripe('@Model.PublicKey');

    initialize();

    // Create a Checkout Session
    async function initialize() {
        const fetchClientSecret = async () => {
            const response = await fetch("@Model.PostbackUrl", {
                method: "POST",
            });
            const { clientSecret } = await response.json();
            return clientSecret;
        };

        const checkout = await stripe.initEmbeddedCheckout({
            fetchClientSecret,
        });

        // Mount Checkout
        checkout.mount('#checkout');
    }
</script>
